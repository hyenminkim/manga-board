<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<th:block th:fragment="header">

    <script src="/webjars/sockjs-client/sockjs.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/common.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/header.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/notification.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
    <script th:src="@{/js/chat.js}"></script>


    <div id="menu" class="header-menu">
        <ul>
            <!-- ★ 로고 -->
            <li class="header-logo">
                <h1>
                    <a th:href="@{/managa/list}">Managa</a>
                </h1>
            </li>
            <li class="header-search">
                <form action="/managa/list">
                    <input type="text" id="keyword" name="keyword" placeholder="제목을 입력해주세요.">
                </form>
            </li>
            <li class="header-chat" sec:authorize="isAuthenticated()">
                <li><a href="#" style="text-decoration:none;" data-bs-toggle="modal" data-bs-target="#chatCreateModal"sec:authorize="isAuthenticated()">채팅방 생성하기</a></li>
                <li><a  style="text-decoration:none;" th:href="@{/chat/list}">채팅방 참여하기</a></li>
            </li>
            <li>
                <li><a th:href="@{/managa/notice}">공지사항</li>
            </li>


            <div class="modal fade" id="chatCreateModal" sec:authorize="isAuthenticated()"  tabindex="-1" aria-labelledby="chatCreateModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="chatCreateModalLabel">채팅방 생성</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
                        </div>
                        <div class="modal-body">
                            <form id="chatCreateForm">
                                <div class="mb-3">
                                    <label for="chatRoomTitle" class="form-label">채팅방 제목</label>
                                    <input type="text" class="form-control" id="title" name="title" required>
                                    <input type="hidden" class="form-control" id="member_id" name="member_id"  th:value="${#authentication.getPrincipal().getMember().id}" required>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" id="createChatBtn">생성</button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                        </div>
                    </div>
                </div>
            </div>



            <li class="header-post">
            <li><a  style="text-decoration:none;" th:href="@{/board/list}">게시글 목록</a></li>
            </li>



            <!-- ★ 프로필 -->
            <li class="header-profile">
                <img width="48" height="48"
                         src="https://img.icons8.com/fluency-systems-regular/48/user-male-circle--v1.png"
                     alt="profile"/>
                <ul>
                    <!--로그인 안했을 때는 로그인만 보여주기-->
                    <li><a sec:authorize="isAnonymous()" type="submit" th:href="@{/user/login}">로그인</a></li>
                    <!--로그인 했을 때는 마이페이지와 로그아웃만 보여주기-->

                    <li><a sec:authorize="isAuthenticated()" th:href="@{/mypage/home}">마이페이지</a></li>
                    <li>
                        <form th:action="@{/user/logout}" method="POST" sec:authorize="isAuthenticated()" th:with="member=${#authentication.getPrincipal().getMember()}">
                            <span class="d-flex">
                            <button class="btn btn-danger" type="submit">Logout</button>
                        </span>
                        </form>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</th:block>

</html>
